---
title: "change"
output: html_document
date: '2022-06-16'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```
##问题五的修改部分
drawTable<-function() 
{
  step<-0.5/10  ##格子大小不变
  x<-seq(0,0.75,by=step)  ##调整列数为15
  y<-seq(0,1.5,by=step)   ##调整行数为30
  gp<-ggplot(data = data.frame(0,0))+xlim(c(0,0.75))+ylim(c(0,1.5))+   ##下面与上面调整一致
    geom_vline(xintercept=seq(0,0.75,by=step),aes(col="gray"))+
    geom_hline(yintercept=seq(0,1.5,by=step),aes(col="gray"))+
    scale_y_continuous(expand=c(0,0))+
    scale_x_continuous(expand = c(0,0))+
    xlab("")+ylab("")+
    theme(axis.title=element_blank(),
          axis.text=element_blank(),
          axis.ticks=element_blank())
  gp
}
##问题二三的修改部分
 observeEvent(input$pressedKey,{
    if (!is.null(input$keyPressed) && Gameon)
    {
      active(FALSE)
      code<-input$keyPressed

      if(code==37) ##Press 左箭头
      {
        cubes<<-MoveLeft(cubes,fullTable)
      }
      if(code==39) ##Press 右箭头
      {
        cubes<<-MoveRight(cubes,fullTable)
      }
      if(code==32) ##Press 空格 一次不行，六次足以
      {
        cubes<<-MoveDown(cubes,fullTable)
        cubes<<-MoveDown(cubes,fullTable)
        cubes<<-MoveDown(cubes,fullTable)
        cubes<<-MoveDown(cubes,fullTable)
        cubes<<-MoveDown(cubes,fullTable)
        cubes<<-MoveDown(cubes,fullTable)
      }
      if(code==65) ##Press A  转270度
      { 
        cubes<<-rotate(cubes,fullTable)
        cubes<<-rotate(cubes,fullTable)
        cubes<<-rotate(cubes,fullTable)
        #cubes<<-MoveRight(cubes)
      }
      if(code==68) ##Press D  
      {
        cubes<<-rotate(cubes,fullTable)

        #cubes<<-MoveRight(cubes)
      }
      active(TRUE)
    }
  })
```

